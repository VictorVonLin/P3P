<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Firebase Realtime Database Test</title>
</head>
<body>
  <h1>Firebase Realtime Database Test</h1>
  <ul id="users"></ul>
  
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js" async defer>
  	// Initialize Firebase
    var firebaseConfig = {
       apiKey: "AIzaSyCTSeoyD9E-jp07mXCfmG3yveu8Rv8R9K0",
       authDomain: "peerify-121.firebaseapp.com",
       databaseURL: "https://peerify-121-default-rtdb.firebaseio.com",
       projectId: "peerify-121",
       storageBucket: "peerify-121.appspot.com",
       messagingSenderId: "85937007914",
       appId: "1:85937007914:web:153d3b0532a4d9c44e0253",
       measurementId: "G-0358DSESS5"
     };
    firebase.initializeApp(firebaseConfig);
    
    // Get a reference to the database
    var dbRef = firebase.database().ref('users');
    
    // Add the current user to the database
    var currentUserRef = dbRef.push();
    var currentUserKey = currentUserRef.key;
    var currentUserData = {
      name: 'User ' + currentUserKey,
      lastSeen: Date.now()
    };
    currentUserRef.set(currentUserData);
    
    // Remove the current user from the database when the page is closed
    currentUserRef.onDisconnect().remove();
    
    // Listen for changes in the user data
    dbRef.on('value', function(snapshot) {
      // Clear the list
      var list = document.getElementById('users');
      list.innerHTML = '';
      
      // Add each user to the list
      snapshot.forEach(function(childSnapshot) {
        var user = childSnapshot.val();
        var li = document.createElement('li');
        li.innerText = user.name + ' (last seen: ' + new Date(user.lastSeen).toLocaleString() + ')';
        list.appendChild(li);
      });
    });
  </script>
  <script>
    
  </script>
</body>
</html>
